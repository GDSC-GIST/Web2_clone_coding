{"ast":null,"code":"var _jsxFileName = \"/Users/yoonjae/GDSC/Web2_clone_coding/src/components/NweetFactory.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from 'react';\nimport { fbStore, fbStorage } from '../fbase';\nimport { v4 as uuidv4 } from 'uuid';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst NweetFactory = props => {\n  _s();\n\n  const [nweet, setNweet] = useState('');\n  const [attachment, setAttachment] = useState('');\n\n  const onSubmit = async event => {\n    event.preventDefault();\n    let attachmentUrl = '';\n\n    if (attachment !== '') {\n      const attachmentRef = fbStorage.ref(fbStorage.getStorage(), `${props.userObj.uid}/${uuidv4()}`);\n      const response = await fbStorage.uploadString(attachmentRef, attachment, 'data_url');\n      attachmentUrl = await fbStorage.getDownloadURL(response.ref);\n    }\n\n    await fbStore.addDoc(fbStore.collection(fbStore.getFirestore(), 'nweets'), {\n      text: nweet,\n      createdAt: Date.now(),\n      creatorId: props.userObj.uid,\n      attachmentUrl\n    });\n    setNweet('');\n    setAttachment('');\n  };\n\n  const onChange = event => {\n    const {\n      target: {\n        value\n      }\n    } = event;\n    setNweet(value);\n  };\n\n  const onFileChange = event => {\n    // console.log(event.target.files);\n    const {\n      target: {\n        files\n      }\n    } = event;\n    const theFile = files[0];\n    const reader = new FileReader();\n\n    reader.onloadend = finishedEvent => {\n      const {\n        currentTarget: {\n          result\n        }\n      } = finishedEvent;\n      console.log(finishedEvent);\n      setAttachment(result);\n    };\n\n    reader.readAsDataURL(theFile);\n  };\n\n  const onClearAttachment = () => {\n    setAttachment('');\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: onSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"text\",\n      onChange: onChange,\n      placeholder: \"What's on your mind?\",\n      maxLength: 120,\n      value: nweet\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      accept: \"image/*\",\n      onChange: onFileChange\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"submit\",\n      value: \"Nweet\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 7\n    }, this), attachment && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"img\", {\n        src: attachment,\n        alt: \"attachment\",\n        width: \"50px\",\n        height: \"50px\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: onClearAttachment,\n        children: \"Clear\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n};\n\n_s(NweetFactory, \"NlUKhtUXb39EDlht2Pm+5GyTQLY=\");\n\n_c = NweetFactory;\nexport default NweetFactory;\n\nvar _c;\n\n$RefreshReg$(_c, \"NweetFactory\");","map":{"version":3,"sources":["/Users/yoonjae/GDSC/Web2_clone_coding/src/components/NweetFactory.js"],"names":["React","useState","fbStore","fbStorage","v4","uuidv4","NweetFactory","props","nweet","setNweet","attachment","setAttachment","onSubmit","event","preventDefault","attachmentUrl","attachmentRef","ref","getStorage","userObj","uid","response","uploadString","getDownloadURL","addDoc","collection","getFirestore","text","createdAt","Date","now","creatorId","onChange","target","value","onFileChange","files","theFile","reader","FileReader","onloadend","finishedEvent","currentTarget","result","console","log","readAsDataURL","onClearAttachment"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport {fbStore, fbStorage} from '../fbase';\nimport {v4 as uuidv4} from 'uuid';\n\nconst NweetFactory = (props) => {\n  const [nweet, setNweet] = useState('');\n  const [attachment, setAttachment] = useState('');\n\n  const onSubmit = async (event) => {\n    event.preventDefault();\n    let attachmentUrl = '';\n    if (attachment !== '') {\n      const attachmentRef = fbStorage.ref(fbStorage.getStorage(), `${props.userObj.uid}/${uuidv4()}`);\n      const response = await fbStorage.uploadString(attachmentRef, attachment, 'data_url');\n      attachmentUrl = await fbStorage.getDownloadURL(response.ref);\n    }\n    await fbStore.addDoc(fbStore.collection(fbStore.getFirestore(), 'nweets'), {\n      text: nweet,\n      createdAt: Date.now(),\n      creatorId: props.userObj.uid,\n      attachmentUrl,\n    });\n    setNweet('');\n    setAttachment('');\n  };\n\n  const onChange = (event) => {\n    const {\n      target: {value},\n    } = event;\n    setNweet(value);\n  };\n\n  const onFileChange = (event) => {\n    // console.log(event.target.files);\n    const {\n      target: {files},\n    } = event;\n    const theFile = files[0];\n    const reader = new FileReader();\n    reader.onloadend = (finishedEvent) => {\n      const {\n        currentTarget: {result},\n      } = finishedEvent;\n      console.log(finishedEvent);\n      setAttachment(result);\n    };\n    reader.readAsDataURL(theFile);\n  };\n\n  const onClearAttachment = () => {\n    setAttachment('');\n  };\n\n  return (\n    <form onSubmit={onSubmit}>\n      <input type=\"text\" onChange={onChange} placeholder=\"What's on your mind?\" maxLength={120} value={nweet} />\n      <input type=\"file\" accept=\"image/*\" onChange={onFileChange} />\n      <input type=\"submit\" value=\"Nweet\" />\n      {attachment && (\n        <div>\n          <img src={attachment} alt=\"attachment\" width=\"50px\" height=\"50px\"></img>\n          <button onClick={onClearAttachment}>Clear</button>\n        </div>\n      )}\n    </form>\n  );\n};\nexport default NweetFactory;\n"]},"metadata":{},"sourceType":"module"}